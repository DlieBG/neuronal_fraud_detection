
<script src="https://d3js.org/d3.v6.min.js"></script>
<div id="tree_plot_a1b0e84333344f43938a67040c29bb41"></div>
<script>
/*
 * Copyright 2021 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 *  Plotting of decision trees generated by TF-DF.
 *
 *  A tree is a recursive structure of node objects.
 *  A node contains one or more of the following components:
 *
 *    - A value: Representing the output of the node. If the node is not a leaf,
 *      the value is only present for analysis i.e. it is not used for
 *      predictions.
 *
 *    - A condition : For non-leaf nodes, the condition (also known as split)
 *      defines a binary test to branch to the positive or negative child.
 *
 *    - An explanation: Generally a plot showing the relation between the label
 *      and the condition to give insights about the effect of the condition.
 *
 *    - Two children : For non-leaf nodes, the children nodes. The first
 *      children (i.e. "node.children[0]") is the negative children (drawn in
 *      red). The second children is the positive one (drawn in green).
 *
 */

/**
 * Plots a single decision tree into a DOM element.
 * @param {!options} options Dictionary of configurations.
 * @param {!tree} raw_tree Recursive tree structure.
 * @param {string} canvas_id Id of the output dom element.
 */
function display_tree(options, raw_tree, canvas_id) {
  console.log(options);

  // Determine the node placement.
  const tree_struct = d3.tree().nodeSize(
      [options.node_y_offset, options.node_x_offset])(d3.hierarchy(raw_tree));

  // Boundaries of the node placement.
  let x_min = Infinity;
  let x_max = -x_min;
  let y_min = Infinity;
  let y_max = -x_min;

  tree_struct.each(d => {
    if (d.x > x_max) x_max = d.x;
    if (d.x < x_min) x_min = d.x;
    if (d.y > y_max) y_max = d.y;
    if (d.y < y_min) y_min = d.y;
  });

  // Size of the plot.
  const width = y_max - y_min + options.node_x_size + options.margin * 2;
  const height = x_max - x_min + options.node_y_size + options.margin * 2 +
      options.node_y_offset - options.node_y_size;

  const plot = d3.select(canvas_id);

  // Tool tip
  options.tooltip = plot.append('div')
                        .attr('width', 100)
                        .attr('height', 100)
                        .style('padding', '4px')
                        .style('background', '#fff')
                        .style('box-shadow', '4px 4px 0px rgba(0,0,0,0.1)')
                        .style('border', '1px solid black')
                        .style('font-family', 'sans-serif')
                        .style('font-size', options.font_size)
                        .style('position', 'absolute')
                        .style('z-index', '10')
                        .attr('pointer-events', 'none')
                        .style('display', 'none');

  // Create canvas
  const svg = plot.append('svg').attr('width', width).attr('height', height);
  const graph =
      svg.style('overflow', 'visible')
          .append('g')
          .attr('font-family', 'sans-serif')
          .attr('font-size', options.font_size)
          .attr(
              'transform',
              () => `translate(${options.margin},${
                  - x_min + options.node_y_offset / 2 + options.margin})`);

  // Plot bounding box.
  if (options.show_plot_bounding_box) {
    svg.append('rect')
        .attr('width', width)
        .attr('height', height)
        .attr('fill', 'none')
        .attr('stroke-width', 1.0)
        .attr('stroke', 'black');
  }

  // Draw the edges.
  display_edges(options, graph, tree_struct);

  // Draw the nodes.
  display_nodes(options, graph, tree_struct);
}

/**
 * Draw the nodes of the tree.
 * @param {!options} options Dictionary of configurations.
 * @param {!graph} graph D3 search handle containing the graph.
 * @param {!tree_struct} tree_struct Structure of the tree (node placement,
 *     data, etc.).
 */
function display_nodes(options, graph, tree_struct) {
  const nodes = graph.append('g')
                    .selectAll('g')
                    .data(tree_struct.descendants())
                    .join('g')
                    .attr('transform', d => `translate(${d.y},${d.x})`);

  nodes.append('rect')
      .attr('x', 0.5)
      .attr('y', 0.5)
      .attr('width', options.node_x_size)
      .attr('height', options.node_y_size)
      .attr('stroke', 'lightgrey')
      .attr('stroke-width', 1)
      .attr('fill', 'white')
      .attr('y', -options.node_y_size / 2);

  // Brackets on the right of condition nodes without children.
  non_leaf_node_without_children =
      nodes.filter(node => node.data.condition != null && node.children == null)
          .append('g')
          .attr('transform', `translate(${options.node_x_size},0)`);

  non_leaf_node_without_children.append('path')
      .attr('d', 'M0,0 C 10,0 0,10 10,10')
      .attr('fill', 'none')
      .attr('stroke-width', 1.0)
      .attr('stroke', '#F00');

  non_leaf_node_without_children.append('path')
      .attr('d', 'M0,0 C 10,0 0,-10 10,-10')
      .attr('fill', 'none')
      .attr('stroke-width', 1.0)
      .attr('stroke', '#0F0');

  const node_content = nodes.append('g').attr(
      'transform',
      `translate(0,${options.node_padding - options.node_y_size / 2})`);

  node_content.append(node => create_node_element(options, node));
}

/**
 * Creates the D3 content for a single node.
 * @param {!options} options Dictionary of configurations.
 * @param {!node} node Node to draw.
 * @return {!d3} D3 content.
 */
function create_node_element(options, node) {
  // Output accumulator.
  let output = {
    // Content to draw.
    content: d3.create('svg:g'),
    // Vertical offset to the next element to draw.
    vertical_offset: 0
  };

  // Conditions.
  if (node.data.condition != null) {
    display_condition(options, node.data.condition, output);
  }

  // Values.
  if (node.data.value != null) {
    display_value(options, node.data.value, output);
  }

  // Explanations.
  if (node.data.explanation != null) {
    display_explanation(options, node.data.explanation, output);
  }

  return output.content.node();
}


/**
 * Adds a single line of text inside of a node.
 * @param {!options} options Dictionary of configurations.
 * @param {string} text Text to display.
 * @param {!output} output Output display accumulator.
 */
function display_node_text(options, text, output) {
  output.content.append('text')
      .attr('x', options.node_padding)
      .attr('y', output.vertical_offset)
      .attr('alignment-baseline', 'hanging')
      .text(text);
  output.vertical_offset += 10;
}

/**
 * Adds a single line of text inside of a node with a tooltip.
 * @param {!options} options Dictionary of configurations.
 * @param {string} text Text to display.
 * @param {string} tooltip Text in the Tooltip.
 * @param {!output} output Output display accumulator.
 */
function display_node_text_with_tooltip(options, text, tooltip, output) {
  const item = output.content.append('text')
                   .attr('x', options.node_padding)
                   .attr('alignment-baseline', 'hanging')
                   .text(text);

  add_tooltip(options, item, () => tooltip);
  output.vertical_offset += 10;
}

/**
 * Adds a tooltip to a dom element.
 * @param {!options} options Dictionary of configurations.
 * @param {!dom} target Dom element to equip with a tooltip.
 * @param {!func} get_content Generates the html content of the tooltip.
 */
function add_tooltip(options, target, get_content) {
  function show(d) {
    options.tooltip.style('display', 'block');
    options.tooltip.html(get_content());
  }

  function hide(d) {
    options.tooltip.style('display', 'none');
  }

  function move(d) {
    options.tooltip.style('display', 'block');
    options.tooltip.style('left', (d.pageX + 5) + 'px');
    options.tooltip.style('top', d.pageY + 'px');
  }

  target.on('mouseover', show);
  target.on('mouseout', hide);
  target.on('mousemove', move);
}

/**
 * Adds a condition inside of a node.
 * @param {!options} options Dictionary of configurations.
 * @param {!condition} condition Condition to display.
 * @param {!output} output Output display accumulator.
 */
function display_condition(options, condition, output) {
  threshold_format = d3.format('r');

  if (condition.type === 'IS_MISSING') {
    display_node_text(options, `${condition.attribute} is missing`, output);
    return;
  }

  if (condition.type === 'IS_TRUE') {
    display_node_text(options, `${condition.attribute} is true`, output);
    return;
  }

  if (condition.type === 'NUMERICAL_IS_HIGHER_THAN') {
    format = d3.format('r');
    display_node_text(
        options,
        `${condition.attribute} >= ${threshold_format(condition.threshold)}`,
        output);
    return;
  }

  if (condition.type === 'CATEGORICAL_IS_IN') {
    display_node_text_with_tooltip(
        options, `${condition.attribute} in [...]`,
        `${condition.attribute} in [${condition.mask}]`, output);
    return;
  }

  if (condition.type === 'CATEGORICAL_SET_CONTAINS') {
    display_node_text_with_tooltip(
        options, `${condition.attribute} intersect [...]`,
        `${condition.attribute} intersect [${condition.mask}]`, output);
    return;
  }

  if (condition.type === 'NUMERICAL_SPARSE_OBLIQUE') {
    display_node_text_with_tooltip(
        options, `Sparse oblique split...`,
        `[${condition.attributes}]*[${condition.weights}]>=${
            threshold_format(condition.threshold)}`,
        output);
    return;
  }

  display_node_text(
      options, `Non supported condition ${condition.type}`, output);
}

/**
 * Adds a value inside of a node.
 * @param {!options} options Dictionary of configurations.
 * @param {!value} value Value to display.
 * @param {!output} output Output display accumulator.
 */
function display_value(options, value, output) {
  if (value.type === 'PROBABILITY') {
    const left_margin = 0;
    const right_margin = 50;
    const plot_width = options.node_x_size - options.node_padding * 2 -
        left_margin - right_margin;

    let cusum = Array.from(d3.cumsum(value.distribution));
    cusum.unshift(0);
    const distribution_plot = output.content.append('g').attr(
        'transform', `translate(0,${output.vertical_offset + 0.5})`);

    distribution_plot.selectAll('rect')
        .data(value.distribution)
        .join('rect')
        .attr('height', 10)
        .attr(
            'x',
            (d, i) =>
                (cusum[i] * plot_width + left_margin + options.node_padding))
        .attr('width', (d, i) => d * plot_width)
        .style('fill', (d, i) => d3.schemeSet1[i]);

    const num_examples =
        output.content.append('g')
            .attr('transform', `translate(0,${output.vertical_offset})`)
            .append('text')
            .attr('x', options.node_x_size - options.node_padding)
            .attr('alignment-baseline', 'hanging')
            .attr('text-anchor', 'end')
            .text(`(${value.num_examples})`);

    const distribution_details = d3.create('ul');
    distribution_details.selectAll('li')
        .data(value.distribution)
        .join('li')
        .append('span')
        .text(
            (d, i) =>
                'class ' + i + ': ' + d3.format('.3%')(value.distribution[i]));

    add_tooltip(options, distribution_plot, () => distribution_details.html());
    add_tooltip(options, num_examples, () => 'Number of examples');

    output.vertical_offset += 10;
    return;
  }

  if (value.type === 'REGRESSION') {
    display_node_text(
        options,
        'value: ' + d3.format('r')(value.value) + ` (` +
            d3.format('.6')(value.num_examples) + `)`,
        output);
    return;
  }

  if (value.type === 'UPLIFT') {
    display_node_text(
        options,
        'effect: ' + d3.format('r')(value.treatment_effect) + ` (` +
            d3.format('.6')(value.num_examples) + `)`,
        output);
    return;
  }

  display_node_text(options, `Non supported value ${value.type}`, output);
}

/**
 * Adds an explanation inside of a node.
 * @param {!options} options Dictionary of configurations.
 * @param {!explanation} explanation Explanation to display.
 * @param {!output} output Output display accumulator.
 */
function display_explanation(options, explanation, output) {
  // Margin before the explanation.
  output.vertical_offset += 10;

  display_node_text(
      options, `Non supported explanation ${explanation.type}`, output);
}


/**
 * Draw the edges of the tree.
 * @param {!options} options Dictionary of configurations.
 * @param {!graph} graph D3 search handle containing the graph.
 * @param {!tree_struct} tree_struct Structure of the tree (node placement,
 *     data, etc.).
 */
function display_edges(options, graph, tree_struct) {
  // Draw an edge between a parent and a child node with a bezier.
  function draw_single_edge(d) {
    return 'M' + (d.source.y + options.node_x_size) + ',' + d.source.x + ' C' +
        (d.source.y + options.node_x_size + options.edge_rounding) + ',' +
        d.source.x + ' ' + (d.target.y - options.edge_rounding) + ',' +
        d.target.x + ' ' + d.target.y + ',' + d.target.x;
  }

  graph.append('g')
      .attr('fill', 'none')
      .attr('stroke-width', 1.2)
      .selectAll('path')
      .data(tree_struct.links())
      .join('path')
      .attr('d', draw_single_edge)
      .attr(
          'stroke', d => (d.target === d.source.children[0]) ? '#0F0' : '#F00');
}

display_tree({"margin": 10, "node_x_size": 160, "node_y_size": 28, "node_x_offset": 180, "node_y_offset": 33, "font_size": 10, "edge_rounding": 20, "node_padding": 2, "show_plot_bounding_box": false}, {"value": {"type": "REGRESSION", "value": 1.1557644029380754e-05, "num_examples": 21553.760477602482, "standard_deviation": 0.4437699916463128}, "condition": {"type": "CATEGORICAL_IS_IN", "attribute": "B_TELEFON", "mask": ["<OOD>", "nein"]}, "children": [{"value": {"type": "REGRESSION", "value": 0.00647443812340498, "num_examples": 18952.099851965904, "standard_deviation": 0.4435788448549163}, "condition": {"type": "CATEGORICAL_IS_IN", "attribute": "ANUMMERS.2", "mask": ["<OOD>", "0", "200959", "108500", "106590", "406203", "405284", "403639", "206520", "205958", "204944", "200578", "406774", "207699", "508777", "501371", "404485", "404341", "303776", "208500", "202243", "104485", "101511", "600578", "408679", "404553", "403203", "402611", "402454", "402399", "206929", "206590", "200450", "104258", "102133", "605580", "509102", "508499", "507699", "507359", "501796", "500925", "407317", "407022", "406406", "404944", "404258", "404159", "402116", "309102", "206774", "204553", "202677", "200124", "109121", "106310", "104645", "100953", "506590", "503136", "409102", "408126", "408096", "407223", "406310", "402845", "402133", "308997", "307699", "306398", "305580", "304258", "303397", "206821", "206310", "201967", "108997", "104341", "103950", "101967", "101893"]}, "children": [{"value": {"type": "REGRESSION", "value": 0.009245018474757671, "num_examples": 18490.74925273657, "standard_deviation": 0.44706525488356313}, "condition": {"type": "NUMERICAL_IS_HIGHER_THAN", "attribute": "SESSION_TIME", "threshold": 2.5}, "children": [{"value": {"type": "REGRESSION", "value": 0.003301615361124277, "num_examples": 16587.0173355937, "standard_deviation": 0.4513678181081119}, "condition": {"type": "CATEGORICAL_IS_IN", "attribute": "NEUKUNDE", "mask": ["<OOD>", "ja"]}}, {"value": {"type": "REGRESSION", "value": 0.06339214742183685, "num_examples": 1903.731917142868, "standard_deviation": 0.3871511521946859}, "condition": {"type": "NUMERICAL_IS_HIGHER_THAN", "attribute": "DATUM_LBEST", "threshold": 731358.5}}]}, {"value": {"type": "REGRESSION", "value": -0.1339695304632187, "num_examples": 461.3505992293358, "standard_deviation": 0.037226592758001296}, "condition": {"type": "CATEGORICAL_IS_IN", "attribute": "ANUMMERS.2", "mask": ["<OOD>", "0", "200959", "108500", "106590", "406203", "405284", "403639", "401285", "401241", "401216", "206520", "205958", "204944", "200953", "200578", "409470", "406774", "402062", "400172", "302611", "207699", "107570", "609670", "600767", "508777", "502133", "501371", "409386", "409333", "409121", "408507", "407703", "407669", "407570", "407359", "406781", "405338", "404485", "404341", "403772", "401967", "309121", "303776", "208500", "206255", "205874", "204522", "202845", "202454", "202399", "202243", "202133", "104935", "104921", "104485", "101511", "100959", "100147", "607046", "606858", "600578", "509006", "505555", "502845", "502454", "502090", "500959", "409731", "409006", "408679", "406520", "406398", "405874", "405685", "404553", "403203", "402611", "402454", "402399", "309006", "302845", "301371", "209121", "208777", "207046", "206929", "206685", "206590", "204242", "202496", "202089", "200476", "200450", "107359", "107300", "104258", "102133", "100578", "609500", "608997", "605580", "603776", "603639", "603397", "509670", "509102", "508499", "507699", "507359", "507317", "504765", "504485", "504159", "503776", "501893", "501796", "500925", "409826", "408605", "408500", "407317", "407162", "407022", "406859", "406507", "406406", "406160", "406120", "405966", "405965", "405897", "405643", "404944", "404258", "404159", "403533", "402116", "401856", "401835", "401648", "400576", "400214", "400035", "309102", "303136", "300925", "300767", "300476", "300124", "209725", "209006", "208801", "206959", "206774", "206507", "205338", "204792", "204645", "204553", "203776", "203639", "203397", "202697", "202677", "201856", "200124", "200035", "109725", "109121", "108397", "106398", "106310", "105685", "104645", "101856", "101796", "100953", "606284", "604485", "603950", "602845", "601371", "600953", "600124", "509500", "508997", "507255", "506590", "505580", "504792", "503136", "502611", "502089", "500147", "409200", "409102", "408777", "408126", "408096", "407223", "407193", "406959", "406897", "406310", "406282", "405580", "405555", "404921", "404645", "404371", "404242", "403397", "402845", "402246", "402133", "401511", "400767", "400450", "400147", "309725", "309670", "309500", "308997", "307699", "306398", "305580", "304258", "303639", "303397", "302496", "302133", "301893", "300578", "209500", "207610", "207570", "207317", "206821", "206504", "206398", "206310", "205284", "204258", "203136", "201967", "201619", "201216", "200767", "200214", "108997", "107255", "107046", "105580", "104341", "103950", "103367", "102681", "102677", "102496", "101967", "101893", "100476"]}, "children": [{"value": {"type": "REGRESSION", "value": -0.13308362662792206, "num_examples": 452.8562268614769, "standard_deviation": 0.026675599912003543}, "condition": {"type": "CATEGORICAL_IS_IN", "attribute": "NEUKUNDE", "mask": ["<OOD>", "ja"]}}, {"value": {"type": "REGRESSION", "value": -0.17537212371826172, "num_examples": 8.494372367858887, "standard_deviation": 0.14941649098901816}, "condition": {"type": "CATEGORICAL_IS_IN", "attribute": "Z_CARD_VALID", "mask": ["<OOD>", "32007", "112006", "22006", "112005", "32005", "22007", "32006", "62005", "12007", "122005", "102005", "92006", "92005", "52007", "12005", "42005", "22005", "72006", "62006", "102007", "122006", "52006", "92007", "72005", "102006", "82005", "62007", "72007", "112007", "52005", "42006"]}}]}]}, {"value": {"type": "REGRESSION", "value": -0.046774446964263916, "num_examples": 2601.6606256365776, "standard_deviation": 0.4295264929755857}, "condition": {"type": "CATEGORICAL_IS_IN", "attribute": "Z_CARD_VALID", "mask": ["<OOD>", "32007", "22007", "82007", "122005", "92006", "52007", "12005", "22005", "72006", "62006", "72005", "102006", "62007", "52005", "82006", "42006"]}, "children": [{"value": {"type": "REGRESSION", "value": -0.0057570370845496655, "num_examples": 1371.0329481959343, "standard_deviation": 0.4505540632872254}, "condition": {"type": "CATEGORICAL_IS_IN", "attribute": "ANUMMERS.0", "mask": ["204792", "504792", "405965", "402845", "404504", "403533", "402734", "109006", "400061", "609725", "403772", "304258", "407344", "404371", "200476", "104792", "600124", "405378", "402993", "307317", "303397", "208500", "104341", "102697", "406203", "405485", "402454", "400172", "306310", "304159", "302611", "201402", "105580", "407741", "406406", "402243", "402062", "400072", "300953", "206774", "204944", "200147", "402278", "407703", "406929", "405338", "404553", "400214", "302677", "209670", "204765", "200767", "105431", "103776", "101619", "609121", "601371", "509725", "509102", "507344", "502611", "409470", "408997", "406858", "406255", "400578", "309102", "206590", "204645", "202993", "201648", "104522", "507699", "503776", "502090", "406398", "406282", "205284", "200035", "106398", "506821", "506284", "500214", "402697", "402133", "400450", "301893", "300214", "200925", "104645", "609006", "500147", "407359", "402123", "306858", "207300", "202399", "101856", "608889", "505555", "504077", "502133", "500953", "409183", "409006", "408777", "408470", "406520", "406310", "405874", "404921", "404134", "209725", "207344", "206959", "206507", "205431", "202845", "200822", "200214", "106685", "104485", "603397", "602089", "509500", "409121", "409015", "409013", "407699", "407022", "309006", "209662", "206504", "206398", "204159", "108997", "104765", "103397", "102845", "507255", "404159", "206685", "204341", "107300", "107255", "605580", "603950", "506398", "505580", "409725", "409102", "406811", "406590", "405966", "404077", "402611", "304485", "206255", "205685", "205580", "205555", "203950", "105685", "606310", "507359", "503367", "409333", "406120", "401893", "400767", "400058", "308801", "306284", "209121", "205966", "202133", "107699", "105338", "101511", "100061", "504921", "503397", "408289", "407416", "407255", "405897", "308997", "308777", "303950", "203136", "202681", "202089", "201511", "108801", "108397", "106504", "103639", "502845", "408500", "407300", "407274", "405284", "404522", "403378", "401285", "303367", "208889", "208609", "208605", "207699", "207156", "202454", "202090", "608997", "607046", "600767", "507317", "506858", "506520", "505685", "409500", "406959", "303639", "201967", "106520", "102089", "101893", "100476", "508801", "500578", "500124", "402677", "309121", "208777", "206520", "204935", "204077", "106821", "102496", "506590", "409782", "404935", "404242", "403776", "401371", "307359", "207359", "200329", "102677", "409513", "408889", "406036", "405540", "207046", "200124", "103136", "609670", "606284", "604258", "508889", "409736", "107046", "601893", "502089", "408397", "402410", "208997", "102454", "101967", "406897", "401373", "209102", "204258", "108777", "407387", "407193", "504485", "407156", "405685", "408801", "408499", "402681", "200578", "300124"]}, "children": [{"value": {"type": "REGRESSION", "value": -0.0505530871450901, "num_examples": 642.2464379668236, "standard_deviation": 0.42780554293855033}, "condition": {"type": "CATEGORICAL_IS_IN", "attribute": "ANUMMERS.0", "mask": ["504792", "405965", "402845", "403533", "402734", "400061", "104792", "600124", "402993", "307317", "104341", "405485", "402454", "400172", "306310", "105580", "402243", "402062", "300953", "402278", "406929", "302677", "200767", "105431", "609121", "509725", "409470", "406858", "406255", "309102", "206590", "204645", "507699", "406398", "406282", "200035", "106398", "506821", "506284", "402133", "400450", "200925", "104645", "609006", "407359", "402123", "306858", "608889", "505555", "504077", "409183", "409006", "406520", "405874", "404134", "206507", "205431", "202845", "106685", "104485", "603397", "602089", "206504", "104765", "103397", "507255", "206685", "605580", "603950", "506398", "409725", "406590", "402611", "304485", "105685", "507359", "406120", "401893", "400767", "400058", "308801", "306284", "209121", "107699", "101511", "100061", "407416", "407255", "405897", "308997", "303950", "201511", "407300", "403378", "401285", "303367", "208889", "208609", "208605", "207156", "202454", "202090", "608997", "607046", "507317", "506858", "505685", "409500", "406959", "201967", "106520", "102089", "100476", "508801", "500578", "500124", "402677", "204935", "106821", "409782", "404935", "403776", "401371", "307359", "102677", "408889", "406036", "405540", "103136", "604258", "408397", "402410", "102454", "406897", "401373", "204258", "108777", "407387", "407193", "504485", "407156", "405685", "408801", "402681"]}}, {"value": {"type": "REGRESSION", "value": 0.03344254195690155, "num_examples": 728.7865102291107, "standard_deviation": 0.4499206128571709}, "condition": {"type": "CATEGORICAL_IS_IN", "attribute": "ANUMMERS.0", "mask": ["406685", "401402", "201619", "400822", "407223", "405767", "407491", "205338", "102448", "500476", "407317", "402496", "404645", "401967", "205874", "202634", "107359", "406005", "209006", "206821", "405958", "402448", "201371", "404735", "402224", "400914", "204723", "202697", "105555", "104935", "509006", "406821", "107570", "604485", "600925", "502496", "203367", "602677", "508997", "503950", "501371", "409386", "406774", "302845", "209386", "203639", "107317", "101796", "100214", "607317", "500925", "408143", "400802", "400329", "306398", "201856", "201216", "109121", "106858", "102090", "405213", "400738", "309725", "200576", "100147", "501796", "405580", "401856", "308889", "307344", "107610", "409731", "400959", "400035", "208397", "206929", "204522", "200061", "104258", "409101", "202448", "202123", "108889", "108500", "506310", "408609", "403367", "207162", "200293", "106590", "100767", "409709", "504765", "501893", "408097", "407171", "309670", "302133", "202677", "109725", "402440", "606858", "304077", "301371", "207317", "402641", "205958", "502454", "207610", "405431", "200953"]}}]}, {"value": {"type": "REGRESSION", "value": -0.09262895584106445, "num_examples": 1230.6276774406433, "standard_deviation": 0.37698660307177384}, "condition": {"type": "CATEGORICAL_IS_IN", "attribute": "ANUMMERS.0", "mask": ["204792", "504792", "406859", "405965", "402734", "109006", "108499", "400061", "609725", "602845", "403772", "407344", "403136", "600124", "507046", "407223", "405378", "307317", "303397", "406203", "405485", "402454", "400172", "306310", "304159", "201402", "102448", "407741", "406406", "300953", "206774", "204944", "608801", "406284", "404645", "205378", "204553", "107359", "100959", "100124", "603367", "407703", "406005", "405338", "402399", "400214", "302677", "302496", "209670", "208499", "206821", "105431", "101619", "601371", "509725", "509102", "507344", "500959", "409470", "408997", "406858", "405958", "309102", "206590", "204645", "202993", "201648", "104921", "507699", "503776", "502090", "408507", "406282", "404341", "402572", "205284", "204723", "200035", "106398", "600578", "509006", "409826", "406954", "303136", "300578", "107570", "103950", "609006", "603776", "600925", "402246", "207300", "206284", "101856", "100925", "605685", "504077", "500953", "409183", "409006", "408096", "406520", "406310", "403546", "209725", "207344", "206959", "205431", "203367", "202845", "202062", "200822", "104485", "603397", "509500", "508997", "501371", "409386", "409015", "409013", "407699", "403203", "305685", "303776", "302845", "302089", "204159", "202469", "200450", "108997", "107317", "102845", "100214", "607317", "509121", "507255", "500925", "402634", "400802", "400329", "206685", "202611", "201216", "106858", "605580", "603950", "508777", "409725", "406811", "406590", "405213", "404944", "403639", "400738", "400147", "309725", "304485", "205685", "200576", "105685", "100147", "507359", "501796", "501511", "406120", "404792", "401856", "401511", "400953", "308889", "308801", "306284", "209121", "205966", "203776", "202133", "107699", "100061", "409731", "408289", "407416", "407255", "401223", "400959", "308997", "303950", "208397", "206929", "204522", "204242", "202681", "201511", "108801", "502845", "409101", "408500", "402294", "400293", "303367", "208609", "207703", "207156", "202448", "108889", "108500", "600767", "507610", "507317", "506858", "506310", "408609", "406959", "405555", "404765", "404269", "403367", "207162", "204921", "201967", "106520", "106284", "101893", "100476", "508801", "504258", "500578", "409709", "406781", "402677", "402090", "309121", "206520", "204935", "203397", "202294", "106821", "104159", "602133", "600476", "506590", "504765", "501893", "409782", "408679", "408097", "407171", "404242", "401371", "302133", "207359", "200329", "109725", "102677", "406507", "405540", "402440", "609670", "606858", "409053", "402089", "304077", "301371", "208801", "207317", "206310", "502089", "402641", "401835", "307699", "208997", "205958", "101967", "407570", "404258", "401373", "209102", "108777", "502454", "407669", "407387", "407193", "504485", "408801", "408499", "405431", "404723", "603136", "401619", "300124", "209736"]}, "children": [{"value": {"type": "REGRESSION", "value": -0.13555175065994263, "num_examples": 584.2307463288307, "standard_deviation": 0.29517434255236147}, "condition": {"type": "CATEGORICAL_IS_IN", "attribute": "Z_CARD_VALID", "mask": ["<OOD>", "32007", "112005", "32005", "22007", "32006", "82007", "122005", "92006", "92005", "52007", "12005", "22005", "72006", "62006", "102007", "92007", "72005", "102006", "62007", "52005", "82006", "42006"]}}, {"value": {"type": "REGRESSION", "value": -0.05397135391831398, "num_examples": 646.3969311118126, "standard_deviation": 0.4179395745182106}, "condition": {"type": "CATEGORICAL_IS_IN", "attribute": "ANUMMERS.0", "mask": ["406685", "401402", "403533", "201619", "400822", "201373", "404371", "104077", "102697", "407491", "302611", "205338", "105580", "500476", "407317", "402062", "200147", "407934", "402278", "401967", "205874", "404553", "306821", "204765", "609121", "502611", "406255", "104522", "404735", "402224", "400914", "607699", "402697", "402133", "301893", "300214", "207171", "104645", "604485", "500147", "402123", "107344", "608889", "502133", "408470", "407364", "405874", "200214", "602677", "602089", "409121", "408605", "408126", "407610", "406774", "404549", "401796", "209662", "206504", "104765", "103397", "101796", "408143", "404485", "202243", "201856", "506398", "505580", "406504", "405966", "206255", "205580", "205555", "107171", "105958", "409333", "405580", "307344", "101511", "504921", "503397", "405897", "203136", "108397", "106504", "509670", "407300", "407274", "403378", "401285", "207699", "202454", "202090", "103367", "506520", "505685", "206858", "102681", "100767", "500124", "400476", "300767", "109670", "403776", "402469", "402116", "309670", "202246", "409513", "408889", "403950", "207255", "200124", "606284", "604258", "409736", "408397", "402410", "400576", "202496", "102454", "204258", "201796", "407046", "405685", "204485", "401216", "200953", "200578"]}}]}]}]}, "#tree_plot_a1b0e84333344f43938a67040c29bb41")
</script>
